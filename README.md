# ðŸŽ° Fortuna - Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÐºÐ¾Ð»ÐµÑÐ° Ñ„Ð¾Ñ€Ñ‚ÑƒÐ½Ñ‹

Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° ÐºÐ¾Ð»ÐµÑÐ° Ñ„Ð¾Ñ€Ñ‚ÑƒÐ½Ñ‹ Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸ÐµÐ¹ Tilda Ð¸ Sendsay Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹ Ð¾ Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹ÑˆÐ°Ñ….

## ðŸš€ Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

- **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ Tilda** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº Ñ‡ÐµÑ€ÐµÐ· webhook
- **ÐšÐ¾Ð»ÐµÑÐ¾ Ñ„Ð¾Ñ€Ñ‚ÑƒÐ½Ñ‹** - ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚Ð¾Ðº Ñ ÑƒÐ¼Ð½Ñ‹Ð¼ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ð¾Ð¼ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ñ€Ð¸Ð·Ð¾Ð²
- **ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð·Ñ‹** - Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð²Ñ‹Ð´Ð°Ñ‡Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð·Ð¾Ð² Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´
- **Email ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· Sendsay
- **Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð·Ð°Ð¼Ð¸** - Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ CRUD Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸
- **Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°** - Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð²Ñ‹Ð¸Ð³Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð·Ð¾Ð² Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹

## ðŸ—ï¸ Ð¢ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸

- **Backend:** NestJS + TypeScript
- **Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…:** PostgreSQL + Prisma ORM
- **ÐšÑÑˆ:** Redis
- **Email:** Sendsay API
- **Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ:** Swagger/OpenAPI
- **ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ:** Docker (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

## ðŸ“‹ Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

- Node.js 18+ 
- PostgreSQL 13+
- Redis 6+
- npm Ð¸Ð»Ð¸ yarn

## ðŸ› ï¸ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°

### 1. ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ

```bash
git clone https://github.com/your-username/fortuna.git
cd fortuna
```

### 2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹

```bash
npm install
```

### 3. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `.env` Ð² ÐºÐ¾Ñ€Ð½Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°:

```bash
# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
cp env.example .env

# ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð»
nano .env
```

**ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ:**
```env
# Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…
DATABASE_URL="postgresql://username:password@localhost:5432/fortuna_db"

# Redis
REDIS_URL="redis://localhost:6379"

# Sendsay (Email ÑÐµÑ€Ð²Ð¸Ñ)
SENDSAY_API_KEY="your_sendsay_api_key"
SENDSAY_LOGIN="your_sendsay_login"
SENDSAY_PASSWORD="your_sendsay_password"

# API ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
BACKEND_URL="http://localhost:3000"
PORT=3000

# JWT ÑÐµÐºÑ€ÐµÑ‚ (ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡)
JWT_SECRET="your_super_secure_jwt_secret_key"

# ÐžÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ
NODE_ENV="development"
```

### 4. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

```bash
# ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹
npx prisma migrate dev

# Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Prisma ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
npx prisma generate

# (ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸
npx prisma db seed
```

### 5. Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

```bash
# Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
npm run start:dev

# ÐŸÑ€Ð¾Ð´Ð°ÐºÑˆÐ½ Ñ€ÐµÐ¶Ð¸Ð¼
npm run build
npm run start:prod
```

## ðŸ³ Docker ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°

### Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº

```bash
# 1. ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°
git clone https://github.com/your-username/fortuna.git
cd fortuna

# 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
cp docker.env .env
nano .env  # ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸

# 3. Ð—Ð°Ð¿ÑƒÑÐº Ñ‡ÐµÑ€ÐµÐ· ÑÐºÑ€Ð¸Ð¿Ñ‚
chmod +x docker-start.sh
./docker-start.sh

# Ð˜Ð»Ð¸ Ñ€ÑƒÑ‡Ð½Ð¾Ð¹ Ð·Ð°Ð¿ÑƒÑÐº
docker-compose up -d
```

### Ð ÑƒÑ‡Ð½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°

1. **ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ:**
   ```bash
   cp docker.env .env
   # ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ .env Ñ„Ð°Ð¹Ð» Ñ Ð²Ð°ÑˆÐ¸Ð¼Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼Ð¸
   ```

2. **Ð—Ð°Ð¿ÑƒÑÐº ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¾Ð²:**
   ```bash
   # Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¸ Ð·Ð°Ð¿ÑƒÑÐº
   docker-compose up --build -d
   
   # ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹
   docker-compose exec app npx prisma migrate deploy
   
   # Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Prisma ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
   docker-compose exec app npx prisma generate
   ```

### Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Docker ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°Ð¼Ð¸

```bash
# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
docker-compose ps

# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð»Ð¾Ð³Ð¾Ð²
docker-compose logs -f app

# ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°
docker-compose down

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº
docker-compose restart app

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ
docker-compose pull
docker-compose up --build -d
```

## ðŸš€ Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ

### 1. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð° (Ubuntu/Debian)

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
sudo apt update && sudo apt upgrade -y

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° PostgreSQL
sudo apt install postgresql postgresql-contrib -y

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Redis
sudo apt install redis-server -y

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° PM2 Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°Ð¼Ð¸
sudo npm install -g pm2

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Nginx (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
sudo apt install nginx -y
```

### 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° PostgreSQL

```bash
# ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ðº Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ postgres
sudo -u postgres psql

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
CREATE DATABASE fortuna_db;
CREATE USER fortuna_user WITH PASSWORD 'your_secure_password';
GRANT ALL PRIVILEGES ON DATABASE fortuna_db TO fortuna_user;
\q
```

### 3. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Redis

```bash
# Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Redis
sudo nano /etc/redis/redis.conf

# Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ Ñ‡Ñ‚Ð¾:
# bind 127.0.0.1
# port 6379
# requirepass your_redis_password (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Redis
sudo systemctl restart redis-server
sudo systemctl enable redis-server
```

### 4. Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

```bash
# ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
git clone https://github.com/your-username/fortuna.git
cd fortuna

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
npm install

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ .env Ñ„Ð°Ð¹Ð»Ð°
cp .env.example .env
nano .env  # ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸

# ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹
npx prisma migrate deploy

# Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Prisma ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
npx prisma generate

# Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
npm run build

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð°Ð¿ÐºÐ¸ Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¾Ðº
mkdir uploads
chmod 755 uploads
```

### 5. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° PM2

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ecosystem Ñ„Ð°Ð¹Ð»Ð°
cat > ecosystem.config.js << EOF
module.exports = {
  apps: [{
    name: 'fortuna',
    script: 'dist/main.js',
    instances: 'max',
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_file: './logs/combined.log',
    time: true
  }]
}
EOF

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð°Ð¿ÐºÐ¸ Ð´Ð»Ñ Ð»Ð¾Ð³Ð¾Ð²
mkdir logs

# Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
pm2 start ecosystem.config.js

# Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ PM2
pm2 save
pm2 startup
```

### 6. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Nginx (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Nginx
sudo nano /etc/nginx/sites-available/fortuna

# Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ„Ð°Ð¹Ð»Ð°:
server {
    listen 80;
    server_name your-domain.com;

    # API Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸Ð·Ð¾Ð²)
    location /uploads {
        alias /path/to/fortuna/uploads;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Swagger Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
    location /api/docs {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}

# ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ ÑÐ°Ð¹Ñ‚Ð°
sudo ln -s /etc/nginx/sites-available/fortuna /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 7. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° SSL (Let's Encrypt)

```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Certbot
sudo apt install certbot python3-certbot-nginx -y

# ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ SSL ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð°
sudo certbot --nginx -d your-domain.com

# ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ
sudo crontab -e
# Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ: 0 12 * * * /usr/bin/certbot renew --quiet
```

## ðŸ“š API Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ:
- **Swagger UI:** `http://localhost:3000/api/docs`
- **JSON Schema:** `http://localhost:3000/api/docs-json`

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹:

- `POST /api/tilda/webhook` - Webhook Ð¾Ñ‚ Tilda Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº
- `GET /api/wheel/session` - ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐµÑÑÐ¸Ð¸ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚Ð¾Ðº
- `POST /api/wheel/spin` - ÐŸÑ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ° ÐºÐ¾Ð»ÐµÑÐ°
- `GET /api/wheel/prizes` - Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð·Ð¾Ð²
- `GET /api/wheel/won-prizes` - Ð’Ñ‹Ð¸Ð³Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð·Ñ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
- `GET /api/mandatory-prizes/active` - ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð·Ñ‹

## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ñ‚ÐµÑÑ‚Ð¾Ð²
npm run test

# Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Tilda Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸
node test-tilda-webhook.js

# Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð»Ð¾Ð³Ð¸ÐºÐ¸ ÑÐµÑÑÐ¸Ð¹
node test-session-logic.js

# Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð±Ð°Ð³Ð¾Ð²
node test-infinite-spins-bug.js

# Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ñ‹Ð¸Ð³Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð·Ð¾Ð²
node test-won-prizes.js
```

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

```
fortuna/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ modules/           # ÐœÐ¾Ð´ÑƒÐ»Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
â”‚   â”‚   â”œâ”€â”€ wheel/        # ÐšÐ¾Ð»ÐµÑÐ¾ Ñ„Ð¾Ñ€Ñ‚ÑƒÐ½Ñ‹
â”‚   â”‚   â””â”€â”€ tilda/        # Tilda Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ
â”‚   â”œâ”€â”€ services/         # Ð‘Ð¸Ð·Ð½ÐµÑ-Ð»Ð¾Ð³Ð¸ÐºÐ°
â”‚   â”œâ”€â”€ config/           # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
â”‚   â””â”€â”€ main.ts          # Ð¢Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°
â”œâ”€â”€ prisma/              # Ð¡Ñ…ÐµÐ¼Ð° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”œâ”€â”€ uploads/             # Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹
â”œâ”€â”€ test-*.js           # Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
â””â”€â”€ docs/               # Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
```

## ðŸ”§ Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°

```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
npm install

# Ð—Ð°Ð¿ÑƒÑÐº Ð² Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
npm run start:dev

# Ð¡Ð±Ð¾Ñ€ÐºÐ°
npm run build

# Ð›Ð¸Ð½Ñ‚Ð¸Ð½Ð³
npm run lint

# Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð°
npm run format
```

## ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³

```bash
# Ð¡Ñ‚Ð°Ñ‚ÑƒÑ PM2 Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð²
pm2 status

# Ð›Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
pm2 logs fortuna

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð²
pm2 monit

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
pm2 restart fortuna
```

## ðŸ”’ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ

- Ð’ÑÐµ API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹ Ð·Ð°Ñ‰Ð¸Ñ‰ÐµÐ½Ñ‹ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸ÐµÐ¹
- Webhook'Ð¸ Ð¾Ñ‚ Tilda Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ñ‹ Ð½Ð° Ð¿Ð¾Ð´Ð»Ð¸Ð½Ð½Ð¾ÑÑ‚ÑŒ
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ HTTPS Ð² Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ðµ
- Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐ¹Ñ‚Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ñ€Ð²Ð¾Ð» Ð´Ð»Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð‘Ð”

## ðŸ¤ Ð’ÐºÐ»Ð°Ð´ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚

1. Ð¤Ð¾Ñ€ÐºÐ½Ð¸Ñ‚Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹
2. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð²ÐµÑ‚ÐºÑƒ Ð´Ð»Ñ Ð½Ð¾Ð²Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ (`git checkout -b feature/amazing-feature`)
3. Ð—Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ (`git commit -m 'Add amazing feature'`)
4. ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð² Ð²ÐµÑ‚ÐºÑƒ (`git push origin feature/amazing-feature`)
5. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Pull Request

## ðŸ“„ Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ

Ð­Ñ‚Ð¾Ñ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ð»Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð¿Ð¾Ð´ MIT License - ÑÐ¼. Ñ„Ð°Ð¹Ð» [LICENSE](LICENSE) Ð´Ð»Ñ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹.

## ðŸ“ž ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°

Ð•ÑÐ»Ð¸ Ñƒ Ð²Ð°Ñ ÐµÑÑ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹:

1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ [Issues](https://github.com/your-username/fortuna/issues)
2. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ Issue Ñ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ð¼ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼
3. Ð¡Ð²ÑÐ¶Ð¸Ñ‚ÐµÑÑŒ Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸

---

**Ð£Ð´Ð°Ñ‡Ð½Ð¾Ð³Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ! ðŸŽ°âœ¨**